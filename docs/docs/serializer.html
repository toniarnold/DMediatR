<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Serializer | DMediatR </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Serializer | DMediatR ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="DMediatR">
            DMediatR
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="serializer">Serializer</h1>

<p>DMediatR uses binary serialization with pluggable custom serializers for specific types to serialize/deserialize,
here with the example of Ping deriving from a custom serializer which counts
the number of times the object has been serialized.</p>
<h2 id="serialization-classes">Serialization Classes</h2>
<div class="lang-plantUml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="CLASS" height="614px" preserveaspectratio="none" style="width:873px;height:614px;background:#FFFFFF;" version="1.1" viewbox="0 0 873 614" width="873px" zoomandpan="magnify"><defs></defs><g><!--cluster MessagePackSerializer--><g id="cluster_MessagePackSerializer"><path d="M427.97,367.27 L610.218,367.27 A3.75,3.75 0 0 1 612.718,369.77 L619.718,389.5669 L619.97,389.5669 A2.5,2.5 0 0 1 622.47,392.0669 L622.47,463.77 A2.5,2.5 0 0 1 619.97,466.27 L427.97,466.27 A2.5,2.5 0 0 1 425.47,463.77 L425.47,369.77 A2.5,2.5 0 0 1 427.97,367.27 " fill="none" style="stroke:#000000;stroke-width:1.5;"></path><line style="stroke:#000000;stroke-width:1.5;" x1="425.47" x2="619.718" y1="389.5669" y2="389.5669"></line><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthadjust="spacing" textlength="181.248" x="429.47" y="382.2651">MessagePackSerializer</text></g><!--class Typeless--><g id="elem_Typeless"><rect codeline="26" fill="#F1F1F1" height="48" id="Typeless" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93.4277" x="442.75" y="402.27"></rect><ellipse cx="457.75" cy="418.27" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M460.7188,423.9106 Q460.1406,424.2075 459.5,424.3481 Q458.8594,424.5044 458.1563,424.5044 Q455.6563,424.5044 454.3281,422.8638 Q453.0156,421.2075 453.0156,418.0825 Q453.0156,414.9575 454.3281,413.3013 Q455.6563,411.645 458.1563,411.645 Q458.8594,411.645 459.5,411.8013 Q460.1563,411.9575 460.7188,412.2544 L460.7188,414.9731 Q460.0938,414.395 459.5,414.1294 Q458.9063,413.8481 458.2813,413.8481 Q456.9375,413.8481 456.25,414.9263 Q455.5625,415.9888 455.5625,418.0825 Q455.5625,420.1763 456.25,421.2544 Q456.9375,422.3169 458.2813,422.3169 Q458.9063,422.3169 459.5,422.0513 Q460.0938,421.77 460.7188,421.1919 L460.7188,423.9106 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="61.4277" x="471.75" y="423.1167">Typeless</text><line style="stroke:#181818;stroke-width:0.5;" x1="443.75" x2="535.1777" y1="434.27" y2="434.27"></line><line style="stroke:#181818;stroke-width:0.5;" x1="443.75" x2="535.1777" y1="442.27" y2="442.27"></line></g><!--class ISerializer--><g id="elem_ISerializer"><rect codeline="4" fill="#F1F1F1" height="113.1875" id="ISerializer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="178.9336" x="233" y="7"></rect><ellipse cx="283.5415" cy="23" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M279.4634,18.7656 L279.4634,16.6094 L286.854,16.6094 L286.854,18.7656 L284.3853,18.7656 L284.3853,26.8438 L286.854,26.8438 L286.854,29 L279.4634,29 L279.4634,26.8438 L281.9321,26.8438 L281.9321,18.7656 L279.4634,18.7656 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthadjust="spacing" textlength="69.3506" x="304.0415" y="27.8467">ISerializer</text><line style="stroke:#181818;stroke-width:0.5;" x1="234" x2="410.9336" y1="39" y2="39"></line><line style="stroke:#181818;stroke-width:0.5;" x1="234" x2="410.9336" y1="47" y2="47"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="91.7314" x="239" y="63.9951">Serialize(obj)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="131.9063" x="239" y="80.292">Serialize(type, obj)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="158.7715" x="239" y="96.5889">Deserialize&lt;T&gt;(bytes)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="166.9336" x="239" y="112.8857">Deserialize(type, bytes)</text></g><!--class Serializer--><g id="elem_Serializer"><rect codeline="11" fill="#F1F1F1" height="129.4844" id="Serializer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="178.9336" x="91" y="180.19"></rect><ellipse cx="143.606" cy="196.19" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M146.5747,201.8306 Q145.9966,202.1275 145.356,202.2681 Q144.7153,202.4244 144.0122,202.4244 Q141.5122,202.4244 140.1841,200.7837 Q138.8716,199.1275 138.8716,196.0025 Q138.8716,192.8775 140.1841,191.2212 Q141.5122,189.565 144.0122,189.565 Q144.7153,189.565 145.356,189.7212 Q146.0122,189.8775 146.5747,190.1744 L146.5747,192.8931 Q145.9497,192.315 145.356,192.0494 Q144.7622,191.7681 144.1372,191.7681 Q142.7935,191.7681 142.106,192.8462 Q141.4185,193.9087 141.4185,196.0025 Q141.4185,198.0962 142.106,199.1744 Q142.7935,200.2369 144.1372,200.2369 Q144.7622,200.2369 145.356,199.9712 Q145.9497,199.69 146.5747,199.1119 L146.5747,201.8306 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="65.2217" x="164.106" y="201.0367">Serializer</text><line style="stroke:#181818;stroke-width:0.5;" x1="92" x2="268.9336" y1="212.19" y2="212.19"></line><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="99" y="222.8384"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="112.3828" x="111" y="229.1851">_typedSerializer</text><line style="stroke:#181818;stroke-width:0.5;" x1="92" x2="268.9336" y1="236.4869" y2="236.4869"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="91.7314" x="97" y="253.482">Serialize(obj)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="131.9063" x="97" y="269.7789">Serialize(type, obj)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="158.7715" x="97" y="286.0757">Deserialize&lt;T&gt;(bytes)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="166.9336" x="97" y="302.3726">Deserialize(type, bytes)</text></g><!--class BinarySerializer--><g id="elem_BinarySerializer"><rect codeline="19" fill="#F1F1F1" height="113.1875" id="BinarySerializer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="178.9336" x="384" y="188.34"></rect><ellipse cx="415.5261" cy="204.34" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M418.4948,209.9806 Q417.9167,210.2775 417.2761,210.4181 Q416.6354,210.5744 415.9323,210.5744 Q413.4323,210.5744 412.1042,208.9337 Q410.7917,207.2775 410.7917,204.1525 Q410.7917,201.0275 412.1042,199.3712 Q413.4323,197.715 415.9323,197.715 Q416.6354,197.715 417.2761,197.8712 Q417.9323,198.0275 418.4948,198.3244 L418.4948,201.0431 Q417.8698,200.465 417.2761,200.1994 Q416.6823,199.9181 416.0573,199.9181 Q414.7136,199.9181 414.0261,200.9962 Q413.3386,202.0587 413.3386,204.1525 Q413.3386,206.2462 414.0261,207.3244 Q414.7136,208.3869 416.0573,208.3869 Q416.6823,208.3869 417.2761,208.1212 Q417.8698,207.84 418.4948,207.2619 L418.4948,209.9806 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="110.209" x="433.1985" y="209.1867">BinarySerializer</text><line style="stroke:#181818;stroke-width:0.5;" x1="385" x2="561.9336" y1="220.34" y2="220.34"></line><line style="stroke:#181818;stroke-width:0.5;" x1="385" x2="561.9336" y1="228.34" y2="228.34"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="91.7314" x="390" y="245.3351">Serialize(obj)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="131.9063" x="390" y="261.632">Serialize(type, obj)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="158.7715" x="390" y="277.9289">Deserialize&lt;T&gt;(bytes)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="166.9336" x="390" y="294.2257">Deserialize(type, bytes)</text></g><!--class TypedSerializer--><g id="elem_TypedSerializer"><rect codeline="30" fill="#F1F1F1" height="113.1875" id="TypedSerializer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="178.9336" x="7" y="369.68"></rect><ellipse cx="39.3197" cy="385.68" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M42.2885,391.3206 Q41.7104,391.6175 41.0697,391.7581 Q40.4291,391.9144 39.726,391.9144 Q37.226,391.9144 35.8979,390.2737 Q34.5854,388.6175 34.5854,385.4925 Q34.5854,382.3675 35.8979,380.7112 Q37.226,379.055 39.726,379.055 Q40.4291,379.055 41.0697,379.2112 Q41.726,379.3675 42.2885,379.6644 L42.2885,382.3831 Q41.6635,381.805 41.0697,381.5394 Q40.476,381.2581 39.851,381.2581 Q38.5072,381.2581 37.8197,382.3362 Q37.1322,383.3987 37.1322,385.4925 Q37.1322,387.5862 37.8197,388.6644 Q38.5072,389.7269 39.851,389.7269 Q40.476,389.7269 41.0697,389.4612 Q41.6635,389.18 42.2885,388.6019 L42.2885,391.3206 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="108.4453" x="57.1686" y="390.5267">TypedSerializer</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="184.9336" y1="401.68" y2="401.68"></line><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="412.3284"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="115.3428" x="27" y="418.6751">_serviceProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="184.9336" y1="425.9769" y2="425.9769"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="131.9063" x="13" y="442.972">Serialize(type, obj)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="166.9336" x="13" y="459.2689">Deserialize(type, bytes)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="132.3711" x="13" y="475.5657">GetSerializer(type)</text></g><!--class CustomSerializer--><g id="elem_CustomSerializer"><rect codeline="39" fill="#F1F1F1" height="80.5938" id="CustomSerializer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="187.2119" x="220.86" y="385.97"></rect><ellipse cx="247.1214" cy="401.97" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M250.0902,407.6106 Q249.5121,407.9075 248.8714,408.0481 Q248.2308,408.2044 247.5277,408.2044 Q245.0277,408.2044 243.6996,406.5637 Q242.3871,404.9075 242.3871,401.7825 Q242.3871,398.6575 243.6996,397.0012 Q245.0277,395.345 247.5277,395.345 Q248.2308,395.345 248.8714,395.5012 Q249.5277,395.6575 250.0902,395.9544 L250.0902,398.6731 Q249.4652,398.095 248.8714,397.8294 Q248.2777,397.5481 247.6527,397.5481 Q246.3089,397.5481 245.6214,398.6262 Q244.9339,399.6887 244.9339,401.7825 Q244.9339,403.8762 245.6214,404.9544 Q246.3089,406.0169 247.6527,406.0169 Q248.2777,406.0169 248.8714,405.7512 Q249.4652,405.47 250.0902,404.8919 L250.0902,407.6106 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="118.8564" x="263.624" y="406.8167">CustomSerializer</text><rect fill="#FFFFFF" height="15.9688" style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" width="9.3301" x="401.7418" y="382.97"></rect><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthadjust="spacing" textlength="7.3301" x="402.7418" y="395.1087">T</text><line style="stroke:#181818;stroke-width:0.5;" x1="221.86" x2="407.0719" y1="417.97" y2="417.97"></line><ellipse cx="231.86" cy="431.6184" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="34.3369" x="240.86" y="434.9651">Type</text><line style="stroke:#181818;stroke-width:0.5;" x1="221.86" x2="407.0719" y1="442.2669" y2="442.2669"></line><polygon fill="#FFFF44" points="231.86,450.9153,235.86,454.9153,231.86,458.9153,227.86,454.9153" style="stroke:#B38D22;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="161.2119" x="240.86" y="459.262">CheckType(givenType)</text></g><!--class SerializationCountSerializer--><g id="elem_SerializationCountSerializer"><rect codeline="44" fill="#F1F1F1" height="64.2969" id="SerializationCountSerializer" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="225.0469" x="201.94" y="542.86"></rect><ellipse cx="216.94" cy="558.86" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M219.9088,564.5006 Q219.3306,564.7975 218.69,564.9381 Q218.0494,565.0944 217.3463,565.0944 Q214.8463,565.0944 213.5181,563.4538 Q212.2056,561.7975 212.2056,558.6725 Q212.2056,555.5475 213.5181,553.8913 Q214.8463,552.235 217.3463,552.235 Q218.0494,552.235 218.69,552.3913 Q219.3463,552.5475 219.9088,552.8444 L219.9088,555.5631 Q219.2838,554.985 218.69,554.7194 Q218.0963,554.4381 217.4713,554.4381 Q216.1275,554.4381 215.44,555.5163 Q214.7525,556.5788 214.7525,558.6725 Q214.7525,560.7663 215.44,561.8444 Q216.1275,562.9069 217.4713,562.9069 Q218.0963,562.9069 218.69,562.6413 Q219.2838,562.36 219.9088,561.7819 L219.9088,564.5006 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="193.0469" x="230.94" y="563.7067">SerializationCountSerializer</text><line style="stroke:#181818;stroke-width:0.5;" x1="202.94" x2="425.9869" y1="574.86" y2="574.86"></line><line style="stroke:#181818;stroke-width:0.5;" x1="202.94" x2="425.9869" y1="582.86" y2="582.86"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="131.9063" x="207.94" y="599.8551">Serialize(type, obj)</text></g><!--class IRequest--><g id="elem_IRequest"><rect codeline="51" fill="#F1F1F1" height="48" id="IRequest" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.1279" x="446.9" y="39.6"></rect><ellipse cx="461.9" cy="55.6" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M457.8219,51.3656 L457.8219,49.2094 L465.2125,49.2094 L465.2125,51.3656 L462.7438,51.3656 L462.7438,59.4438 L465.2125,59.4438 L465.2125,61.6 L457.8219,61.6 L457.8219,59.4438 L460.2906,59.4438 L460.2906,51.3656 L457.8219,51.3656 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthadjust="spacing" textlength="61.626" x="475.9" y="60.4467">IRequest</text><rect fill="#FFFFFF" height="15.9688" style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" width="67.502" x="545.526" y="36.6"></rect><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthadjust="spacing" textlength="65.502" x="546.526" y="48.7387">TResponse</text><line style="stroke:#181818;stroke-width:0.5;" x1="447.9" x2="609.0279" y1="71.6" y2="71.6"></line><line style="stroke:#181818;stroke-width:0.5;" x1="447.9" x2="609.0279" y1="79.6" y2="79.6"></line></g><!--class SerializationCountMessage--><g id="elem_SerializationCountMessage"><rect codeline="54" fill="#F1F1F1" height="64.2969" id="SerializationCountMessage" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="221.1846" x="644.87" y="31.45"></rect><ellipse cx="659.87" cy="47.45" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M662.8388,53.0906 Q662.2606,53.3875 661.62,53.5281 Q660.9794,53.6844 660.2763,53.6844 Q657.7763,53.6844 656.4481,52.0437 Q655.1356,50.3875 655.1356,47.2625 Q655.1356,44.1375 656.4481,42.4812 Q657.7763,40.825 660.2763,40.825 Q660.9794,40.825 661.62,40.9812 Q662.2763,41.1375 662.8388,41.4344 L662.8388,44.1531 Q662.2138,43.575 661.62,43.3094 Q661.0263,43.0281 660.4013,43.0281 Q659.0575,43.0281 658.37,44.1062 Q657.6825,45.1687 657.6825,47.2625 Q657.6825,49.3562 658.37,50.4344 Q659.0575,51.4969 660.4013,51.4969 Q661.0263,51.4969 661.62,51.2312 Q662.2138,50.95 662.8388,50.3719 L662.8388,53.0906 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="189.1846" x="673.87" y="52.2967">SerializationCountMessage</text><line style="stroke:#181818;stroke-width:0.5;" x1="645.87" x2="865.0546" y1="63.45" y2="63.45"></line><ellipse cx="655.87" cy="77.0984" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="41.5762" x="664.87" y="80.4451">Count</text><line style="stroke:#181818;stroke-width:0.5;" x1="645.87" x2="865.0546" y1="87.7469" y2="87.7469"></line></g><!--class Ping--><g id="elem_Ping"><rect codeline="58" fill="#F1F1F1" height="64.2969" id="Ping" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.3594" x="654.79" y="212.78"></rect><ellipse cx="681.1604" cy="228.78" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"></ellipse><path d="M684.1292,234.4206 Q683.551,234.7175 682.9104,234.8581 Q682.2698,235.0144 681.5667,235.0144 Q679.0667,235.0144 677.7385,233.3737 Q676.426,231.7175 676.426,228.5925 Q676.426,225.4675 677.7385,223.8112 Q679.0667,222.155 681.5667,222.155 Q682.2698,222.155 682.9104,222.3112 Q683.5667,222.4675 684.1292,222.7644 L684.1292,225.4831 Q683.5042,224.905 682.9104,224.6394 Q682.3167,224.3581 681.6917,224.3581 Q680.3479,224.3581 679.6604,225.4362 Q678.9729,226.4987 678.9729,228.5925 Q678.9729,230.6862 679.6604,231.7644 Q680.3479,232.8269 681.6917,232.8269 Q682.3167,232.8269 682.9104,232.5612 Q683.5042,232.28 684.1292,231.7019 L684.1292,234.4206 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="30.0918" x="697.6872" y="233.6267">Ping</text><line style="stroke:#181818;stroke-width:0.5;" x1="655.79" x2="741.1494" y1="244.78" y2="244.78"></line><ellipse cx="665.79" cy="258.4284" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="61.3594" x="674.79" y="261.7751">Message</text><line style="stroke:#181818;stroke-width:0.5;" x1="655.79" x2="741.1494" y1="269.0769" y2="269.0769"></line></g><!--reverse link ISerializer to Serializer--><g id="link_ISerializer_Serializer"><path d="M267.1433,134.4696 C252.2433,153.2796 246.67,160.33 231.29,179.74 " fill="none" id="ISerializer-backto-Serializer" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;"></path><polygon fill="none" points="278.32,120.36,262.4401,130.7441,271.8465,138.1952,278.32,120.36" style="stroke:#181818;stroke-width:1;"></polygon></g><!--reverse link ISerializer to BinarySerializer--><g id="link_ISerializer_BinarySerializer"><path d="M381.0119,134.1306 C399.1019,155.6206 408.17,166.38 426.29,187.9 " fill="none" id="ISerializer-backto-BinarySerializer" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;"></path><polygon fill="none" points="369.42,120.36,376.4217,137.9945,385.6021,130.2666,369.42,120.36" style="stroke:#181818;stroke-width:1;"></polygon></g><!--link BinarySerializer to Typeless--><g id="link_BinarySerializer_Typeless"><path codeline="28" d="M478.44,301.69 C481.45,335.42 484.5981,370.6736 486.8481,395.9536 " fill="none" id="BinarySerializer-to-Typeless" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="487.38,401.93,490.5664,392.6108,486.9367,396.9497,482.5979,393.32,487.38,401.93" style="stroke:#181818;stroke-width:1;"></polygon></g><!--reverse link Serializer to TypedSerializer--><g id="link_Serializer_TypedSerializer"><path codeline="37" d="M145.29,321.037 C136.25,340.337 131.5,350.48 122.73,369.2 " fill="none" id="Serializer-backto-TypedSerializer" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="150.38,310.17,144.2127,313.9068,145.29,321.037,151.4573,317.3002,150.38,310.17" style="stroke:#181818;stroke-width:1;"></polygon></g><!--reverse link Serializer to CustomSerializer--><g id="link_Serializer_CustomSerializer"><path d="M239.2398,324.5926 C258.0798,349.8226 268.35,363.55 284.9,385.7 " fill="none" id="Serializer-backto-CustomSerializer" style="stroke:#181818;stroke-width:1;"></path><polygon fill="none" points="228.47,310.17,234.4323,328.1825,244.0473,321.0027,228.47,310.17" style="stroke:#181818;stroke-width:1;"></polygon></g><!--reverse link ISerializer to CustomSerializer--><g id="link_ISerializer_CustomSerializer"><path d="M320.8309,138.5556 C319.2009,212.0556 316.77,321.32 315.35,385.63 " fill="none" id="ISerializer-backto-CustomSerializer" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;"></path><polygon fill="none" points="321.23,120.56,314.8324,138.4225,326.8294,138.6886,321.23,120.56" style="stroke:#181818;stroke-width:1;"></polygon></g><!--reverse link CustomSerializer to SerializationCountSerializer--><g id="link_CustomSerializer_SerializationCountSerializer"><path d="M314.47,484.98 C314.47,508.75 314.47,520.53 314.47,542.64 " fill="none" id="CustomSerializer-backto-SerializationCountSerializer" style="stroke:#181818;stroke-width:1;"></path><polygon fill="none" points="314.47,466.98,308.47,484.98,320.47,484.98,314.47,466.98" style="stroke:#181818;stroke-width:1;"></polygon></g><!--reverse link SerializationCountMessage to Ping--><g id="link_SerializationCountMessage_Ping"><path d="M740.086,112.9938 C729.686,145.7038 718.9,179.65 708.47,212.45 " fill="none" id="SerializationCountMessage-backto-Ping" style="stroke:#181818;stroke-width:1;"></path><polygon fill="none" points="745.54,95.84,734.3681,111.1758,745.804,114.8118,745.54,95.84" style="stroke:#181818;stroke-width:1;"></polygon></g><!--reverse link IRequest to Ping--><g id="link_IRequest_Ping"><path d="M563.0725,101.1042 C593.2225,132.9142 634.8,176.77 668.51,212.33 " fill="none" id="IRequest-backto-Ping" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;"></path><polygon fill="none" points="550.69,88.04,558.7177,105.2317,567.4272,96.9767,550.69,88.04" style="stroke:#181818;stroke-width:1;"></polygon></g><!--SRC=[lPDDReCm48NtFiL8NOJ-q1D4B9fALHTLKSg-CcPAdO2XsA3IAdUl8O0DRgIimWhcsM- -UJOhUCEAqup_O4MuK5XzK8RmRAhmIq0_Ky4hujtregJQ4kzW4XvHZj8w2houLIWTPTWqY0T2M4Qbj720vsM6EGeb_-7nuRqpI2pyIs8-S46hzbpOIr6ze9GqnP2olM6uZ_JQJ2k4EDI-7u2HZoRHF5QJj-xUS8PXLJGySV8-FSOSjXEVK9a6lTmFOJMzyVqboCYtgQKgSbFNAG5-AnJ96RVdECnjxzs_Ni7c4zc- -_PItg28HfhvVQIA5s9JrC8YdzekaPnZjyBHpcHbf0HUunqofUEtVhyjVjKerJhQeYmB8J4Wfu66KmSOX-khPeIGYzH9oDrk1pRqdno7DUJm1m00]--></g></svg></div>
<h2 id="custom-serialization-sequence-for-class-ping">Custom Serialization Sequence for Class Ping</h2>
<p>The corresponding sequence diagram hints at the serialization class dispatch mechanism:</p>
<div class="lang-plantUml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="SEQUENCE" height="551px" preserveaspectratio="none" style="width:766px;height:551px;background:#FFFFFF;" version="1.1" viewbox="0 0 766 551" width="766px" zoomandpan="magnify"><defs></defs><g><rect fill="#FFFFFF" height="430.7266" style="stroke:#181818;stroke-width:1;" width="10" x="186.9858" y="67.4297"></rect><rect fill="#FFFFFF" height="330.3281" style="stroke:#181818;stroke-width:1;" width="10" x="343.4702" y="138.6953"></rect><rect fill="#FFFFFF" height="229.9297" style="stroke:#181818;stroke-width:1;" width="10" x="518.2163" y="209.9609"></rect><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="693.8442" y="381.625"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="36.2969" y2="516.1563"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="191.375" x2="191.375" y1="36.2969" y2="516.1563"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="348.2476" x2="348.2476" y1="36.2969" y2="516.1563"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="522.6929" x2="522.6929" y1="36.2969" y2="516.1563"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="698.7397" x2="698.7397" y1="36.2969" y2="516.1563"></line><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.375" x="5" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="123.375" x="12" y="24.9951">RemoteExtension</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.375" x="5" y="515.1563"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="123.375" x="12" y="535.1514">RemoteExtension</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="79.2217" x="152.375" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="65.2217" x="159.375" y="24.9951">Serializer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="79.2217" x="152.375" y="515.1563"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="65.2217" x="159.375" y="535.1514">Serializer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.4453" x="287.2476" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="108.4453" x="294.2476" y="24.9951">TypedSerializer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.4453" x="287.2476" y="515.1563"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="108.4453" x="294.2476" y="535.1514">TypedSerializer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="207.0469" x="419.6929" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="193.0469" x="426.6929" y="24.9951">SerializationCountSerializer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="207.0469" x="419.6929" y="515.1563"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="193.0469" x="426.6929" y="535.1514">SerializationCountSerializer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124.209" x="636.7397" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="110.209" x="643.7397" y="24.9951">BinarySerializer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124.209" x="636.7397" y="515.1563"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="110.209" x="643.7397" y="535.1514">BinarySerializer</text><rect fill="#FFFFFF" height="430.7266" style="stroke:#181818;stroke-width:1;" width="10" x="186.9858" y="67.4297"></rect><rect fill="#FFFFFF" height="330.3281" style="stroke:#181818;stroke-width:1;" width="10" x="343.4702" y="138.6953"></rect><rect fill="#FFFFFF" height="229.9297" style="stroke:#181818;stroke-width:1;" width="10" x="518.2163" y="209.9609"></rect><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="693.8442" y="381.625"></rect><polygon fill="#181818" points="174.9858,63.4297,184.9858,67.4297,174.9858,71.4297,178.9858,67.4297" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="73.6875" x2="180.9858" y1="67.4297" y2="67.4297"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="85.1792" x="80.6875" y="62.3638">Serialize(obj)</text><line style="stroke:#181818;stroke-width:1;" x1="196.9858" x2="238.9858" y1="96.5625" y2="96.5625"></line><line style="stroke:#181818;stroke-width:1;" x1="238.9858" x2="238.9858" y1="96.5625" y2="109.5625"></line><line style="stroke:#181818;stroke-width:1;" x1="197.9858" x2="238.9858" y1="109.5625" y2="109.5625"></line><polygon fill="#181818" points="207.9858,105.5625,197.9858,109.5625,207.9858,113.5625,203.9858,109.5625" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.4844" x="203.9858" y="91.4966">Serialize(type, obj)</text><polygon fill="#181818" points="331.4702,134.6953,341.4702,138.6953,331.4702,142.6953,335.4702,138.6953" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="196.9858" x2="337.4702" y1="138.6953" y2="138.6953"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.4844" x="203.9858" y="133.6294">Serialize(type, obj)</text><line style="stroke:#181818;stroke-width:1;" x1="353.4702" x2="395.4702" y1="167.8281" y2="167.8281"></line><line style="stroke:#181818;stroke-width:1;" x1="395.4702" x2="395.4702" y1="167.8281" y2="180.8281"></line><line style="stroke:#181818;stroke-width:1;" x1="354.4702" x2="395.4702" y1="180.8281" y2="180.8281"></line><polygon fill="#181818" points="364.4702,176.8281,354.4702,180.8281,364.4702,184.8281,360.4702,180.8281" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.916" x="360.4702" y="162.7622">GetSerializer(type)</text><polygon fill="#181818" points="506.2163,205.9609,516.2163,209.9609,506.2163,213.9609,510.2163,209.9609" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="353.4702" x2="512.2163" y1="209.9609" y2="209.9609"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.4844" x="360.4702" y="204.895">Serialize(type, obj)</text><line style="stroke:#181818;stroke-width:1;" x1="528.2163" x2="570.2163" y1="239.0938" y2="239.0938"></line><line style="stroke:#181818;stroke-width:1;" x1="570.2163" x2="570.2163" y1="239.0938" y2="252.0938"></line><line style="stroke:#181818;stroke-width:1;" x1="529.2163" x2="570.2163" y1="252.0938" y2="252.0938"></line><polygon fill="#181818" points="539.2163,248.0938,529.2163,252.0938,539.2163,256.0938,535.2163,252.0938" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.916" x="535.2163" y="234.0278">GetSerializer(type)</text><polygon fill="#181818" points="207.9858,277.2266,197.9858,281.2266,207.9858,285.2266,203.9858,281.2266" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="201.9858" x2="517.2163" y1="281.2266" y2="281.2266"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.4844" x="213.9858" y="276.1606">Serialize(type, obj)</text><polygon fill="#181818" points="331.4702,306.3594,341.4702,310.3594,331.4702,314.3594,335.4702,310.3594" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="196.9858" x2="337.4702" y1="310.3594" y2="310.3594"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.4844" x="203.9858" y="305.2935">Serialize(type, obj)</text><line style="stroke:#181818;stroke-width:1;" x1="353.4702" x2="395.4702" y1="339.4922" y2="339.4922"></line><line style="stroke:#181818;stroke-width:1;" x1="395.4702" x2="395.4702" y1="339.4922" y2="352.4922"></line><line style="stroke:#181818;stroke-width:1;" x1="354.4702" x2="395.4702" y1="352.4922" y2="352.4922"></line><polygon fill="#181818" points="364.4702,348.4922,354.4702,352.4922,364.4702,356.4922,360.4702,352.4922" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.916" x="360.4702" y="334.4263">GetSerializer(type)</text><polygon fill="#181818" points="681.8442,377.625,691.8442,381.625,681.8442,385.625,685.8442,381.625" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="353.4702" x2="687.8442" y1="381.625" y2="381.625"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="122.4844" x="360.4702" y="376.5591">Serialize(type, obj)</text><polygon fill="#181818" points="539.2163,406.7578,529.2163,410.7578,539.2163,414.7578,535.2163,410.7578" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="533.2163" x2="697.8442" y1="410.7578" y2="410.7578"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="39.1841" x="545.2163" y="405.6919">byte[]</text><polygon fill="#181818" points="364.4702,435.8906,354.4702,439.8906,364.4702,443.8906,360.4702,439.8906" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="358.4702" x2="522.2163" y1="439.8906" y2="439.8906"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="39.1841" x="370.4702" y="434.8247">byte[]</text><polygon fill="#181818" points="207.9858,465.0234,197.9858,469.0234,207.9858,473.0234,203.9858,469.0234" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="201.9858" x2="347.4702" y1="469.0234" y2="469.0234"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="39.1841" x="213.9858" y="463.9575">byte[]</text><polygon fill="#181818" points="84.6875,494.1563,74.6875,498.1563,84.6875,502.1563,80.6875,498.1563" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="78.6875" x2="190.9858" y1="498.1563" y2="498.1563"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="39.1841" x="90.6875" y="493.0903">byte[]</text><!--SRC=[hLCx3i8m3DrpYenKeXTWO00XTc1336dh8GYIABY8SdggIj3K-J5qS_nvVdvsZB0eQsc4Gdw0kqROlH3KGsh5Z1CxWfNY9jzW9-vJPw29nBvkWJtOLhSA8uaRgOJjd21ZX0elrmw3rMWlT7KjcAXHFWM2ot8quyNOir_o0MAQJiQArFpQKXN8EuYu1qUE0RK8rQL4pD5ABY0Lp3SEiVyNSTOTp2WrFSESlDxPKWSlipfM7SBvmXg8ewPb3SthWoOlmPE2xCg7e_TEYiddJH42-m40]--></g></svg></div>
<h2 id="injecting-custom-serializers">Injecting Custom Serializers</h2>
<p>DMediatR leverages keyed dependency injection introduced in .NET 8 to look up
custom serializers for a particular type. This excerpt from the
<code>ServiceCollectionExtension</code> registers along with the required infrastructure
the two custom serializers <code>SerializationCountSerializer</code> and <code>X509CertificateSerializer</code>:</p>
<pre><code class="lang-csharp">services.TryAddSingleton&lt;TypedSerializer&gt;();
services.TryAddSingleton&lt;ISerializer, Serializer&gt;();
services.TryAddKeyedSingleton&lt;ISerializer, BinarySerializer&gt;(typeof(object)); // recursion base case for TypedSerializer
services.TryAddKeyedSingleton&lt;ISerializer, SerializationCountSerializer&gt;(SerializationCountSerializer.Type);
services.TryAddKeyedSingleton&lt;ISerializer, X509CertificateSerializer&gt;(X509CertificateSerializer.Type);
</code></pre><h3 id="custom-serializer-implementation">Custom Serializer Implementation</h3>
<p>Custom serializers inherit from the generic class <code>CustomSerializer&lt;T&gt;</code> with the class to
register the serializer for as type parameter. They can override one or both of the
<code>Serialize</code> and <code>Deserialize</code> methods. This can be used e.g. for dehydrating an object by
nulling out non-serializable members before serialization and then for rehydrating it after
deserialization by setting the members again with instances from DI on the destination node.</p>
<p>The <code>SerializationCountSerializer</code> is used to trace the number of node hops a DMediatR
message (IRequest or INotification) has taken:</p>
<pre><code class="lang-csharp">namespace DMediatR
{
    public class SerializationCountSerializer : CustomSerializer&lt;SerializationCountMessage&gt;
    {
        public SerializationCountSerializer(IServiceProvider serviceProvider) : base(serviceProvider)
        {
        }

        /// &lt;summary&gt;
        /// Before serializing increment the object's Count property.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;obj&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public override byte[] Serialize(Type type, object obj)
        {
            CheckType(type);
            ((SerializationCountMessage)obj).Count++;
            return base.Serialize(type, obj, checkType: false);
        }
    }
}
</code></pre>
<p>The <code>X509CertificateSerializer</code> needs the injected password from configuration to decrypt
the .pfx binary for both operations and uses plain <code>byte[]</code> serialization for it:</p>
<pre><code class="lang-csharp">using Microsoft.Extensions.Options;
using System.Security.Cryptography.X509Certificates;

namespace DMediatR
{
    internal class X509CertificateSerializer : CustomSerializer&lt;X509Certificate2&gt;
    {
        private readonly PasswordOptions _options;

        public X509CertificateSerializer(IServiceProvider serviceProvider,
            IOptions&lt;PasswordOptions&gt; options) : base(serviceProvider)
        {
            _options = options.Value;
        }

        public override byte[] Serialize(Type type, object obj)
        {
            CheckType(type);
            return base.Serialize(typeof(byte[]), ((X509Certificate2)obj).RawData, checkType: false);
        }

        public override object Deserialize(Type type, byte[] bytes)
        {
            CheckType(type);
            var rawData = (byte[])base.Deserialize(typeof(byte[]), bytes, checkType: false);
            var cert = new X509Certificate2(rawData, _options.Password);
            return (dynamic)cert;
        }
    }
}
</code></pre>
</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
